<div class="kyc-container">
  <mat-card *ngIf="!isLoading; else loadingSpinner">
    <mat-card-title>KYC Verification</mat-card-title>
    <mat-card-content *ngIf="kycStatus" [ngSwitch]="kycStatus.status">
      
      <!-- View for NOT_STARTED -->
      <div *ngSwitchCase="'NOT_STARTED'">
        <h3>Upload Your Document</h3>
        <p>Please upload a clear image of a valid identification document (e.g., Passport, Driver's License) to get verified.</p>
        <div class="upload-section">
          <input type="file" #fileInput (change)="onFileSelected($event)" style="display: none;">
          <button mat-stroked-button (click)="fileInput.click()">
            <mat-icon>attach_file</mat-icon>
            Choose File
          </button>
          <span *ngIf="selectedFile" class="file-name">{{ selectedFile.name }}</span>
        </div>
        <button mat-raised-button color="primary" (click)="onSubmit()" [disabled]="!selectedFile || isSubmitting">
          <span *ngIf="!isSubmitting">Submit for Review</span>
          <span *ngIf="isSubmitting">Submitting...</span>
        </button>
      </div>

      <!-- View for REJECTED -->
      <div *ngSwitchCase="'REJECTED'" class="status-box rejected">
        <h3>Submission Rejected</h3>
        <p>Unfortunately, your previous document submission could not be approved. Please review the notes below and resubmit.</p>
        <mat-divider></mat-divider>
        <p><strong>Administrator Notes:</strong></p>
        <p class="notes">{{ kycStatus.reviewerNotes || 'No notes provided.' }}</p>
        <div class="upload-section">
          <input type="file" #fileInputRejected (change)="onFileSelected($event)" style="display: none;">
          <button mat-stroked-button (click)="fileInputRejected.click()">
            <mat-icon>attach_file</mat-icon>
            Choose New File
          </button>
          <span *ngIf="selectedFile" class="file-name">{{ selectedFile.name }}</span>
        </div>
        <button mat-raised-button color="primary" (click)="onSubmit()" [disabled]="!selectedFile || isSubmitting">
          <span *ngIf="!isSubmitting">Resubmit Document</span>
          <span *ngIf="isSubmitting">Submitting...</span>
        </button>
      </div>

      <!-- View for PENDING -->
      <div *ngSwitchCase="'PENDING'" class="status-box pending">
        <mat-icon>hourglass_top</mat-icon>
        <h3>Documents Under Review</h3>
        <p>Your documents have been submitted successfully and are now pending review. This process may take up to 24 hours. We will notify you once the review is complete.</p>
      </div>

      <!-- View for APPROVED -->
      <div *ngSwitchCase="'APPROVED'" class="status-box approved">
        <mat-icon>verified</mat-icon>
        <h3>Account Verified</h3>
        <p>Congratulations! Your account has been fully verified. You now have access to all platform features.</p>
      </div>

    </mat-card-content>
  </mat-card>

  <!-- Loading Spinner Template -->
  <ng-template #loadingSpinner>
    <div class="spinner-container">
      <mat-spinner></mat-spinner>
    </div>
  </ng-template>
</div>